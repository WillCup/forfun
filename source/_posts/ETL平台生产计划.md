
title: ETL平台生产计划
date: 2017-01-20 15:54:46
tags: [youdaonote]
---


模块 |功能简介| 功效| 备注 | 进度
---|---|---|--- | ---
数据导出|分批定时|易于操作，一个调度时间，多个任务。减少人员修改数据调度的时间【当需要批量修改的时候】|  调度的时候不再提供任务参数配置，只能在任务里这一个地方配置
~~任务恢复~~|任务执行中失败，修复后，原地爬起|避免重复执行前面已经成功的调度，提高资源使用价值，减少数据恢复需要的时间| 方案：抽取azkaban的今日调度最新一次executions，找到失败的job，恢复执行。【看了一下azkaban的mysql数据结构，很难支持】   <br> **最后方案**：通过生成指定几个etl，重新生成其子节点的调度任务 | 完成
调度审核|所有需要上线的调度，都需专人review|保证线上集群的稳定运行，将风险降到最低
数据导出依赖感知|数据导出对平日ETL调度的依赖感知|对每日调度产生强依赖，不空跑|细粒度感知： 血统父表完成 <br> 粗粒度感知：调度完成
指定重新执行的脉路 | 生成指定ETL的所有子节点的调度 | 由于单个节点数据问题，导致所有子节点都要重跑的时候，一键完成 | 可以与上面的任务回复同效 | 完成
生成二代ETL模型 | 抽象出一个有依赖、有自己引擎的ETL模型，m2h/h2h/h2m/spark等都与这个东西关联，生成DAG的时候按照这个东西去生成 | 解决多重任务之间的依赖调度问题 | 可以作为2.0计划，改动稍大
HDFS概览 | 记录指定文件夹每天的数据量变化 | 各个业务线可以方便的看到自己数据库甚至表的大小变化情况 | 优先级别并不高，主要是为了提前预知一些突飞猛涨的数据目录，采取限制或者扩展的措施 | 
非正常操作报警 |出现数据调度变更，或者ETL对象变更的时候， 如果发起人并不是前一个发起人的话，就发送邮件或者短信通知，告诉前一个发起人，有人修改了你负责的东西 | 跨部门或者同部门人员出现误操作后，可追溯到责任人 | 调度可以通过在WillDependencyTask里添加完成，ETL对象可以在通用被继承的对象里完成。最简单可以通过log实现，但是不具备及时性，而且log是会定时清理的
YARN界面开放 | 开发给业务端开发人员查看，但是需要登陆权限验证，还有就是需要替换掉一些后端的url为代理的url，尽量让业务端少知晓后面的任何事情 | 辅助业务端人员调试 | 这个跟上一个功能一样，是个辅助功能, 可以共同放在一个辅助模块中 | 

















docker化的nginx

```
docker run -d -p 80:80 -p 7070:7070 -p 8088:8088 -p 7000:7000 -p 9000:9000 -p 9090:9090 --name willnginx -v /server/wil/willnginx/conf.d:/etc/nginx/conf.d nginx:1.10
```
