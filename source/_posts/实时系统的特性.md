
title: 实时系统的特性
date: 2017-11-22 14:20:41
tags: [youdaonote]
---

#### 关键特性

首先，各个微服务之间应该是解耦的，最好通过stream进行结构。

- 持久化，把数据流暂存起来，供消费。具体持久化的时间，可以根据自己的业务处理
- 高性能，最快的处理每个环节，最大化单个处理单元的吞吐量
- 易扩展性，主要是易于应对数据量的海量增加

参考：https://www.youtube.com/watch?v=4lUxf5pzAHs


####  Move from State to Flow

把微服务中的state转移到flow中去。

如果多个微服务都更新自己的state到同一个本地存储【比如mysql】，那么这个mysql就会变成一个比较危险的地方。如果我们单个微服务要修改mysql的配置，其他几个服务也要受到影响。

但是我们期望，每个微服务自己有修改的时候，相互之间没有影响，每个微服务的变化都是独立的。假设有A,B,C三个微服务，如果给C单独的mysql，那么c对于A,B就是完全独立的。然后针对A,B,C的更新操作全部看作business event放入一个queue，然后再由consumer从queue里消费event，针对不同的event进行处理。


参考：https://www.youtube.com/watch?v=_xqK0Es9zP4

#### 财政部门的flow数据架构

state| flow|
---|---
共享的DB | 不共享任何，只共享flow
复杂的语义，需要小心的使用事务 | 好的沟通规范
人们较熟悉 | 生活中的真实流程
控制流 + state更新 | 控制流 + offset/message

bank1和bank2都监听同一个message queue，处理过后持久化到自己的私有db。

参考：https://www.youtube.com/watch?v=vG2qxjkqOgA
